diff -Nurd lua-5.3/src/loslib.c lua-5.3/src/loslib.c
--- lua-5.3/src/loslib.c	2015-02-12 21:13:58.132496638 +0200
+++ lua-5.3/src/loslib.c	2015-02-12 21:12:52.020498089 +0200
@@ -58,7 +58,7 @@
 ** uses mkstemp.
 */
 
-#if defined(LUA_USE_POSIX)	/* { */
+#if defined(LUA_USE_MKSTEMP)	/* { */
 
 #include <unistd.h>
 
diff -Nurd lua-5.3/src/luaconf.h lua-5.3/src/luaconf.h
--- lua-5.3/src/luaconf.h	2015-02-12 21:13:58.132496638 +0200
+++ lua-5.3/src/luaconf.h	2015-02-12 21:12:25.356498674 +0200
@@ -11,6 +11,7 @@
 #include <limits.h>
 #include <stddef.h>
 
+#include "localluaconf.h"
 
 /*
 ** ===================================================================
@@ -61,14 +62,12 @@
 #if defined(LUA_USE_LINUX)
 #define LUA_USE_POSIX
 #define LUA_USE_DLOPEN		/* needs an extra library: -ldl */
-#define LUA_USE_READLINE	/* needs some extra libraries */
 #endif
 
 
 #if defined(LUA_USE_MACOSX)
 #define LUA_USE_POSIX
 #define LUA_USE_DLOPEN		/* MacOS does not need -ldl */
-#define LUA_USE_READLINE	/* needs an extra library: -lreadline */
 #endif
 
 
